{{- if .Values.api.enabled }}

apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Values.api.name }}-cm
data:
  {{- if .Values.redis.enabled }}
  REDIS_URL: "redis://{{ .Values.redis.service.name }}:{{ .Values.redis.service.port }}"
  {{- else }}
  REDIS_URL: {{ .Values.global.redis_url | quote }}
  {{- end }}
  {{- if .Values.global.environment.shared.redis_key_prefix }}
  REDIS_KEY_PREFIX: {{ .Values.global.environment.shared.redis_key_prefix | quote }}
  {{- end }}
  {{- if .Values.global.environment.shared.redis_max_buffer_size_sec }}
  REDIS_MAX_BUFFER_SIZE_SEC: {{ .Values.global.environment.shared.redis_max_buffer_size_sec | quote }}
  {{- end }}
  {{- if .Values.global.environment.shared.grace_period_seconds }}
  GRACE_PERIOD_SEC: {{ .Values.global.environment.shared.grace_period_seconds | quote }}
  {{- end }}
  {{- if .Values.global.environment.shared.window_resolution_seconds }}
  WINDOW_RESOLUTION_SEC: {{ .Values.global.environment.shared.window_resolution_seconds | quote }}
  {{- end }}
  {{- if .Values.api.env.gin_mode }}
  GIN_MODE: {{ .Values.api.env.gin_mode | quote }}
  {{- else }}
  GIN_MODE: "release"
  {{- end }}
  {{- if .Values.api.env.max_request_bytes }}
  MAX_REQUEST_BYTES: {{ .Values.api.env.max_request_bytes | quote }}
  {{- end }}
  {{- if .Values.api.env.digiusher_k8s_api_url }}
  K8S_API_URL: {{ .Values.api.env.digiusher_k8s_api_url | quote }}
  {{- end }}

{{- end }}